# Лабораторная работа №8

Подключение MongoDB к приложению Express.js

**Цель**: изучить объект promise, его методы и синтаксис async/await, изучить принцип документо-ориентированных бд и MongoDB в частности, реализовать подключение базы данных к веб-приложению.

## Содержание и порядок выполнения лабораторной работы

1. Изучить объект promise, его методы и синтаксис async/await.
1. Установить MongoDB Community Server. [Ссылка для скачивания](https://www.mongodb.com/try/download/community) на официальном сайте.
1. При установке можно отключить добавление пользователя в систему. MongoDB Compass лучше установить.
1. Создайте папку где будут храниться данные приложения.
1. Для запуска сервера перейдите в папку, где установлена MongoDB и выполните команду `.\mongod --port 27017 --dbpath ПУТЬ-ДО-СОЗДАННОЙ-ПАПКИ`.
1. С помощью MongoDB Compass проверьте работоспособность сервера.
1. В вашем проекте создайте новые папки controllers, services, configs.
1. В configs добавьте файл js и в нем создайте функцию, которая возвращает объект базы данных, которая будет использоваться в сервисах.
1. В services добавьте файл js и в нем создайте функции, которые работают с БД, то есть получают и добавляют документы в БД. Методы MongoDB: find() + toArray(), findOne(), insertOne().
1. В controllers добавьте файл js и в нем создайте функции, которые проверяют входящие запросы и вызывают соответствующие сервисы или отправляют ответ об ошибке.
1. Новый функционал добавьте в новую версию API, описание добавьте к index.html.
1. Обновите .http для тестирования новых запросов.

## Функционал

GET /comments - для получения списка всех комментариев из БД.
GET /comments/:id - для получения конкретного комментария из БД. Проверить корректность id, при несуществующем документе вернуть 404.
POST /comments - для добавления нового комментария в БД. В теле запроса должен содержаться json c именем пользователя и текстом, содержание тела проверить в соответствующем контроллере. В качестве ответа возвращается новый список всех комментариев.

Если запрос отправляется на несуществующий url, возвращается ответ со статусом 400.

В БД для комментария должен храниться уникальный id, имя пользователя, текст, дата создания.

## Результаты выполнения лабораторной работы:

Работающий локально сервер с подключением к бд и логикой, которая соответствует требованиям. Код сохранен в системе контроля версий.

## Источники

1. [Асинхронность в JS](https://doka.guide/js/async-in-js/)
1. [Promise](https://doka.guide/js/promise/)
1. [Промисы, async/await](https://learn.javascript.ru/async)
1. [Официальная документация MongoDB](https://www.mongodb.com/docs/manual/)
1. [Онлайн-руководство по MongoDB](https://metanit.com/nosql/mongodb/)
1. [Документация драйвера под Node](https://www.mongodb.com/docs/drivers/node/current/)

## Вопросы

1. Что такое Promise?
1. Для чего нужны методы then, catch, finally?
1. Как работает async/await?
1. В чем заключается идея документо-ориентированных бд?
1. Как создать подключение к MongoDB?
1. Какие методы из драйвера для node используются для чтения и добавления документов в MongoDB?
1. Для чего используются контроллеры и сервисы?
